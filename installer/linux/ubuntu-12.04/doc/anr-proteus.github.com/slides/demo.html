<!DOCTYPE html>
<!--
  Copyright 2010 Google Inc.

  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

     http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.

  Original slides: Marcin Wichary (mwichary@google.com)
  Modifications: Ernest Delgado (ernestd@google.com)
                 Alex Russell (slightlyoff@chromium.org)

  landslide modifications: Adam Zapletal (adamzap@gmail.com)
                           Nicolas Perriault (nperriault@gmail.com)
-->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Demonstration: MORSE &amp; ROS</title>
    <!-- Styles -->
    
    <link rel="stylesheet" media="print" href="default/css/print.css">
    <link rel="stylesheet" media="screen, projection" href="default/css/screen.css">
    
    
    <!-- /Styles -->
    <!-- Javascripts -->
    
    <script type="text/javascript" src="default/js/slides.js"></script>
    
    
    <!-- /Javascripts -->
</head>
<body>
  <div id="blank"></div>
  <div class="presentation">
    <div id="current_presenter_notes">
      <div id="presenter_note"></div>
    </div>
    <div class="slides">
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Demonstration: MORSE &amp; ROS</h1></header>
            
            
            <section><p>Pierrick Koch - <a href="https://www.greyc.fr/">GREYC</a> - <a href="http://www.cnrs.fr/">CNRS</a></p>
<p><a href="http://anr-proteus.fr/">anr-proteus.fr</a></p>
<p>Objectif: First step with ROS and MORSE.</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              1/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>ROS</h1></header>
            
            
            <section><p>Robot Operating System (ROS) can be seen as 2 main parts:</p>
<ul>
<li>A communication <a href="http://en.wikipedia.org/wiki/Middleware">middleware</a>,
with related APIs (C++, Python, Java),</li>
<li>A set of Robotic software (hardware abstraction, drivers, libs).</li>
</ul>
<p><a href="http://ros.org/wiki/roscore">roscore</a>: run a
<a href="http://ros.org/wiki/Master">master</a> <a href="http://ros.org/wiki/Nodes">node</a></p>
<pre><code>roscore
</code></pre>
<p><em>TIP</em>: to stop <code>roscore</code>: press Ctrl+C in the terminal</p>
<p>Basic commands:</p>
<p><a href="http://ros.org/wiki/roscd">roscd</a>: change directory within ROS environment</p>
<pre><code>Usage: roscd [package]
</code></pre>
<p><a href="http://ros.org/wiki/roslaunch">roslaunch</a>:
launching ROS nodes via <code>.launch</code> files</p>
<pre><code>Usage: roslaunch [options] [package] &lt;filename&gt; [arg_name:=value...]
</code></pre>
<p>cf. <a href="http://ros.org/wiki/ROS/Tutorials">Tutorials</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              2/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>rostopic</h1></header>
            
            
            <section><pre><code>rostopic
rostopic is a command-line tool for printing information about ROS Topics.

Commands:
  rostopic bw    display bandwidth used by topic
  rostopic echo  print messages to screen
  rostopic find  find topics by type
  rostopic hz    display publishing rate of topic
  rostopic info  print information about active topic
  rostopic list  list active topics
  rostopic pub   publish data to topic
  rostopic type  print topic type

Type rostopic &lt;command&gt; -h for more detailed usage, e.g. 'rostopic echo -h'
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              3/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>rostopic: exemple</h1></header>
            
            
            <section><p>Publish &amp; print a message on ROS bus:</p>
<pre><code>rostopic pub /test std_msgs/String "Bonjour Proteus"
rostopic echo /test
</code></pre>
<p><a href="http://ros.org/wiki/rostopic"><img alt="rostopic" src="http://anr-proteus.github.com/slides/misc/screenshot-rostopic.png" title="rostopic" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              4/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE</h1></header>
            
            
            <section><p>Developped at LAAS/CNRS in Toulouse (France), MORSE is a generic robotic
simulation platform based on Blender. Blender is a free and open source 3D
modelisation platform. Which integrates differents methods for 3D rendering,
animating, and a game engine used by MORSE for the simulation, as well as the
physic engine Bullet. MORSE allow to build a robotic simulation by using Blender
GUI / API.</p>
<p>Blender 2.5 introduced a new API allowing to interact with all scene-data
through the Blender Python API, aka. <code>bpy</code>.</p>
<p><a href="http://www.blender.org/development/release-logs/blender-256-beta/data-access"><img alt="blender-data-api" src="http://anr-proteus.github.com/slides/misc/blender-data-api.jpg" title="blender-data-api" /></a></p>
<p><a href="http://download.blender.org/release/"><img alt="blender-roadmap" src="http://anr-proteus.github.com/slides/misc/blender-roadmap.jpg" title="blender-roadmap" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              5/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE</h1></header>
            
            
            <section><p><a href="http://morse.openrobots.org"><img alt="morse" src="http://anr-proteus.github.com/slides/misc/screenshot-morse.png" title="morse" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              6/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE GLSL</h1></header>
            
            
            <section><p>MORSE is <a href="http://www.openrobots.org/morse/doc/latest/user/installation.html#hardware">meant</a>
to run with a graphic card compatible <a href="http://en.wikipedia.org/wiki/GLSL">OpenGL Shading Language</a></p>
<h1>ATI/AMD Radeon <a href="http://support.amd.com/us/gpudownload/linux/Pages/radeon_linux.aspx"><img alt="AMD" src="http://support.amd.com/Style%20Library/Images/AMD/AMD_logo.png" title="AMD" /></a></h1>
<h3>9x00, Xx00, X1x00, HD2x00, HD3x00 &amp; +</h3>
<p><code>sudo apt-get install</code> <a href="http://apt.ubuntu.com/p/xserver-xorg-video-radeon"><code>xserver-xorg-video-radeon</code></a></p>
<h1>nVidia <a href="http://www.nvidia.com/object/unix.html"><img alt="nvidia" src="http://www.nvidia.com/content/includes/images/redesign08/nvidia_logo.png" title="nvidia" /></a></h1>
<h3>Geforce FX, 6x00, 7x00, 8x00, 9x00, GTX 2x0 &amp; +</h3>
<p><code>sudo apt-get install</code> <a href="http://apt.ubuntu.com/p/nvidia-current"><code>nvidia-current</code></a></p>
<p>cf. <a href="http://www.blender.org/features-gallery/requirements/">Blender System Requirements</a>
<a href="http://www.blender.org/development/release-logs/blender-248/realtime-glsl-materials/">Blender 2.48 Realtime GLSL Materials</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              7/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE config</h1></header>
            
            
            <section><ul>
<li>Coordinates: <a href="http://en.wikibooks.org/wiki/Blender_3D:_Noob_to_Pro/Understanding_Coordinates">main droite</a></li>
</ul>
<p><img alt="right" src="http://upload.wikimedia.org/wikipedia/commons/thumb/7/79/Rechte-hand-regel.jpg/200px-Rechte-hand-regel.jpg" title="right" /></p>
<ul>
<li>Units: metric, angle: degree in UI, radian in simulation</li>
<li>ROS: <a href="http://ros.org/reps/rep-0103.html">ROS Standard Units of Measure and Coordinate Conventions</a></li>
</ul>
<p><img alt="metric" src="http://anr-proteus.github.com/slides/misc/screenshot-morse-metric.png" title="metric" /></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              8/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE &amp; ROS</h1></header>
            
            
            <section><ul>
<li>Naming convention of <a href="http://www.openrobots.org/morse/doc/latest/user/middlewares/ros.html#generation-of-ros-node-and-topics">topics</a></li>
</ul>
<p><code>/Robot/Composant</code> alphanumeric CamelCase</p>
<h3>ie.</h3>
<pre><code>rostopic list -v

Published topics:
 * /ATRV/CameraMain [sensor_msgs/Image] 1 publisher
 * /rosout [rosgraph_msgs/Log] 1 publisher
 * /ATRV/Pose_sensor [nav_msgs/Odometry] 1 publisher
 * /rosout_agg [rosgraph_msgs/Log] 1 publisher
 * /ATRV/Odometry [geometry_msgs/Twist] 1 publisher
 * /ATRV/Sick [sensor_msgs/LaserScan] 1 publisher

Subscribed topics:
 * /rosout [rosgraph_msgs/Log] 1 subscriber
 * /ATRV/Motion_Controller [geometry_msgs/Twist] 1 subscriber
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              9/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE CLI</h1></header>
            
            
            <section><p>Once installed, MORSE is launch by the command <code>morse {check,edit,run} [scene]</code>,
it accept differents parameters:</p>
<ul>
<li>.blend file (simulation scene)</li>
<li>.py file (scene builder script)</li>
</ul>
<p>ie:</p>
<pre><code>morse edit my_builder_script.py

morse edit my_saved_scene.blend
</code></pre>
<p>... respectively result in:</p>
<ol>
<li>edit a scene build through a script in Blender GUI.</li>
<li>edit a scene saved in a .blend file in Blender GUI.</li>
</ol></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              10/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE: simulation loop</h1></header>
            
            
            <section><p><a href="http://www.openrobots.org/morse/doc/latest/dev/dev_overview.html#morse-execution-loop"><img alt="morse-main-loop" src="http://anr-proteus.github.com/slides/misc/morse_main_loop.png" title="morse-main-loop" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              11/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>MORSE: scene builder API</h1></header>
            
            
            <section><p><a href="http://www.openrobots.org/morse/doc/latest/dev/builder.html"><img alt="morse-builder" src="http://anr-proteus.github.com/slides/misc/morsebuilder_uml.png" title="morse-builder" /></a></p>
<p>cf. <a href="http://www.openrobots.org/morse/doc/latest/dev/builder.html">openrobots.org/morse/doc/latest/dev/builder.html</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              12/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Demo: intro</h1></header>
            
            
            <section><h1>robot made of one controler (v, ω)</h1>
<table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">morse.builder</span> <span class="kn">import</span> <span class="o">*</span>

<span class="c"># Add the robot</span>
<span class="n">simplebot</span> <span class="o">=</span> <span class="n">Robot</span><span class="p">(</span><span class="s">&#39;atrv&#39;</span><span class="p">)</span>

<span class="c"># Add a motion controler</span>
<span class="n">motion</span> <span class="o">=</span> <span class="n">Actuator</span><span class="p">(</span><span class="s">&#39;v_omega&#39;</span><span class="p">)</span>
<span class="n">motion</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="n">z</span><span class="o">=</span><span class="mf">0.3</span><span class="p">)</span>
<span class="c"># Connect the controler to the robot</span>
<span class="n">simplebot</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">motion</span><span class="p">)</span>

<span class="c"># Configure the controler with the ROS middleware</span>
<span class="n">motion</span><span class="o">.</span><span class="n">configure_mw</span><span class="p">(</span><span class="s">&#39;ros&#39;</span><span class="p">)</span>

<span class="c"># Setup the environment</span>
<span class="n">env</span> <span class="o">=</span> <span class="n">Environment</span><span class="p">(</span><span class="s">&#39;indoors-1/indoor-1&#39;</span><span class="p">)</span>
<span class="n">env</span><span class="o">.</span><span class="n">aim_camera</span><span class="p">([</span><span class="mf">1.0470</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">0.7854</span><span class="p">])</span>
</pre></div>
</td></tr></table>
<p>(<a href="https://github.com/anr-proteus/proteus/blob/master/proteus_demo/data/wifibot.py">code</a>)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              13/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Demo: intro (2)</h1></header>
            
            
            <section><h1>commands to run</h1>
<h2>start a ROS master node</h2>
<pre><code>roscore
</code></pre>
<h2>start MORSE with a builder script (in another Terminal)</h2>
<pre><code>morse edit /usr/local/share/morse/examples/scenarii/ros_example.py
</code></pre>
<h3>⌨ Press "<code>P</code>" in the 3D view to start the simulation (Game Engine)</h3>
<h3>⌨ Use "<code>CTRL</code>" + mouse, and "<code>Z, Q/A, S, D/W</code>" to move the camera</h3>
<h2>publish a message on the controler topic (in another Terminal)</h2>
<pre><code>rostopic pub -1 /ATRV/Motion_Controller geometry_msgs/Twist [1,0,0] [0,0,1]
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              14/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Demo: intro (video)</h1></header>
            
            
            <section><iframe src="http://player.vimeo.com/video/22116926?portrait=0" width="800" height="500" frameborder="0" allowfullscreen></iframe>

<p>(<a href="http://vimeo.com/22116926">video</a>)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              15/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>ROS Python3 support</h1></header>
            
            
            <section><p>If you installed ROS through the PROTEUS Debian repository, aka.
<a href="http://apt.ubuntu.com/p/proteus-base"><code>proteus-base</code></a>, you won't need this
patch, you can ignore this slide and jump to the next one. If not you will need
to patch ROS due to a regression in their Python3 compatibility, as:</p>
<pre><code>wget http://anr-proteus.github.com/slides/rospy3k.patch
sudo patch -Np0 &lt; rospy3k.patch
</code></pre>
<p><em>TIP</em>: if ROS is not in <code>/opt/ros</code>, patch as:</p>
<pre><code>roscd common_msgs
wget http://anr-proteus.github.com/slides/rospy3k.patch -O - | patch -Np5
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              16/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Demo: advanced</h1></header>
            
            
            <section><h1>obstacles avoidance w/ laser</h1>
<pre><code>mkdir -p ~/work/ros-addons
rosinstall ~/work/ros-addons /opt/ros/electric/ \
    http://anr-proteus.github.com/proteus.rosinstall
source ~/work/ros-addons/setup.bash
roscd proteus_demo &amp;&amp; git pull &amp;&amp; cd data
morse run wifibot.py
</code></pre>
<h2>run the master node (in another Terminal)</h2>
<pre><code>roscore
</code></pre>
<h2>launch our node to control the robot (in another Terminal)</h2>
<pre><code>source ~/work/ros-addons/setup.bash
roslaunch proteus_demo AvoidObstacleLaser.launch
</code></pre>
<p><em>TIP</em>: if <code>rosinstall</code> is not recognized, install it as:</p>
<pre><code>sudo pip install -U rosinstall
</code></pre></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              17/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Demo: advanced (video)</h1></header>
            
            
            <section><iframe src="http://player.vimeo.com/video/24550587?portrait=0" width="800" height="500" frameborder="0" allowfullscreen></iframe>

<p>(<a href="http://vimeo.com/24550587">video</a>)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              18/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide has_code">
          <div class="inner">
            
            <header><h1>Demo: advanced (code)</h1></header>
            
            
            <section><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29</pre></div></td><td class="code"><div class="highlight"><pre><span class="c"># callback for each laser scan</span>
<span class="k">def</span> <span class="nf">handle_sick</span><span class="p">(</span><span class="n">msg</span><span class="p">):</span>
    <span class="n">mid</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">)</span> <span class="o">//</span> <span class="mi">2</span>
    <span class="n">cmd</span> <span class="o">=</span> <span class="n">Twist</span><span class="p">()</span>
    <span class="c"># stop if an object is less than 2m in a 30deg angle</span>
    <span class="n">halt</span><span class="o">=</span><span class="bp">False</span>
    <span class="k">for</span> <span class="n">distance_to_object</span> <span class="ow">in</span> <span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="n">mid</span><span class="o">-</span><span class="mi">15</span><span class="p">:</span><span class="n">mid</span><span class="o">+</span><span class="mi">15</span><span class="p">]:</span>
        <span class="k">if</span> <span class="n">distance_to_object</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">halt</span><span class="o">=</span><span class="bp">True</span>
            <span class="k">break</span>
    <span class="k">if</span> <span class="n">halt</span><span class="p">:</span>
        <span class="c"># rotate on the wider scanned side</span>
        <span class="k">if</span> <span class="nb">sum</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[:</span><span class="n">mid</span><span class="p">])</span> <span class="o">&gt;</span> <span class="nb">sum</span><span class="p">(</span><span class="n">msg</span><span class="o">.</span><span class="n">ranges</span><span class="p">[</span><span class="n">mid</span><span class="p">:]):</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">cmd</span><span class="o">.</span><span class="n">angular</span><span class="o">.</span><span class="n">z</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">cmd</span><span class="o">.</span><span class="n">linear</span><span class="o">.</span><span class="n">x</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="c"># publie the command to the controler (Twist msg)</span>
    <span class="n">topic</span><span class="o">.</span><span class="n">publish</span><span class="p">(</span><span class="n">cmd</span><span class="p">)</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">init_node</span><span class="p">(</span><span class="s">&#39;wander&#39;</span><span class="p">)</span>
    <span class="n">topic</span><span class="o">=</span><span class="n">rospy</span><span class="o">.</span><span class="n">Publisher</span><span class="p">(</span><span class="s">&#39;/ATRV/Motion_Controller&#39;</span><span class="p">,</span> <span class="n">Twist</span><span class="p">)</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">Subscriber</span><span class="p">(</span><span class="s">&#39;/ATRV/Sick&#39;</span><span class="p">,</span> <span class="n">LaserScan</span><span class="p">,</span> <span class="n">handle_sick</span><span class="p">)</span>
    <span class="n">rospy</span><span class="o">.</span><span class="n">spin</span><span class="p">()</span>

<span class="c"># http://ros.org/doc/api/sensor_msgs/html/msg/LaserScan.html</span>
<span class="c"># http://ros.org/doc/api/geometry_msgs/html/msg/Twist.html</span>
</pre></div>
</td></tr></table>
<p>(<a href="https://github.com/anr-proteus/proteus/blob/master/proteus_demo/nodes/AvoidObstacleLaser.py">code</a>)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              19/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Demo: Orocos</h1></header>
            
            
            <section><p>The example's code is available on <a href="https://github.com/anr-proteus/proteus/tree/master/proteus_orocos_obstaclelaser">GitHub</a></p>
<pre><code>roscd proteus_demo/data
morse run wifibot.py

rosmake proteus_orocos_obstaclelaser
roslaunch proteus_orocos_obstaclelaser AvoidObstacleLaser.launch
</code></pre>
<p><a href="https://github.com/anr-proteus/proteus/tree/master/proteus_orocos_obstaclelaser"><img alt="morse-orocos" src="http://anr-proteus.github.com/slides/misc/screenshot-morse-orocos.png" title="morse-orocos" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              20/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>RViz (video)</h1></header>
            
            
            <section><iframe src="http://player.vimeo.com/video/23244699?portrait=0" width="800" height="375" frameborder="0" allowfullscreen></iframe>

<pre><code>rosrun rviz rviz
</code></pre>
<h2>launch rviz with a configuration file</h2>
<pre><code>roscd proteus_demo/data
rosrun rviz rviz -d rviz.vcg
</code></pre>
<p>(<a href="http://vimeo.com/23244699">video</a>)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              21/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Outdoor (video)</h1></header>
            
            
            <section><iframe src="http://player.vimeo.com/video/26054198?portrait=0" width="800" height="350" frameborder="0" allowfullscreen></iframe>

<pre><code>roscd proteus_demo/data
morse run wifibot.py
</code></pre>
<p>(<a href="http://vimeo.com/26054198">video</a>)</p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              22/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Exploration (Bosch demo w/ Stage)</h1></header>
            
            
            <section><pre><code>sudo apt-get install ros-electric-bosch-common
roslaunch explore_stage explore.launch

roscd explore_stage
rosrun rviz rviz -d explore.vcg
</code></pre>
<p><a href="http://ros.org/wiki/explore_stage"><img alt="exploration" src="http://anr-proteus.github.com/slides/misc/screenshot-explor.png" title="exploration" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              23/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Exploration (Bosch demo w/ MORSE)</h1></header>
            
            
            <section><iframe src="http://www.youtube.com/embed/videoseries?list=PL289431A5B18BD997&amp;hd=1&amp;rel=0" width="800" height="500" frameborder="0" allowfullscreen></iframe></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              24/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>RTMaps</h1></header>
            
            
            <section><p><a href="http://intempora.com"><img alt="rtmaps" src="http://anr-proteus.github.com/slides/misc/screenshot-morse-rtmaps.png" title="rtmaps" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              25/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>TIPS</h1></header>
            
            
            <section><p>MORSE create cache files in the current directory,</p>
<pre><code>rm scene.*.blend
</code></pre>
<p>allow you to delete those files.</p>
<h1>Resources</h1>
<p>Blender Cookie: <a href="http://cgcookie.com/blender/">cgcookie.com/blender</a></p>
<p>Blend Swap: <a href="http://www.blendswap.com/">blendswap.com</a>
(ie. <a href="http://www.blendswap.com/3D-models/vehicles/rover/">Rover model</a> )</p>
<p>Blender Wiki: <a href="http://wiki.blender.org/">wiki.blender.org</a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              26/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>Build a robot</h1></header>
            
            
            <section><iframe src="http://www.youtube.com/embed/videoseries?list=PLDC1FC34E5AC69429&amp;hd=1&amp;rel=0" width="800" height="500" frameborder="0" allowfullscreen></iframe></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              27/28
            </aside>
          </footer>
        </div>
      </div>
      
      <!-- slide source: demo.md -->
      <div class="slide-wrapper">
        <div class="slide">
          <div class="inner">
            
            <header><h1>That's all Folks!</h1></header>
            
            
            <section><p>short link to this presentation: <a href="http://bit.ly/proteus2">bit.ly/proteus2</a></p>
<p><img alt="proteus-morse-demo" src="http://bit.ly/proteus2.qrcode" title="proteus-morse-demo" /></p>
<p>1 page doc: <a href="http://bit.ly/proteus2md">bit.ly/proteus2md</a></p>
<p>sources on GitHub: <a href="http://bit.ly/proteus-src">bit.ly/proteus-src</a></p>
<p><em>made with</em> <a href="https://github.com/adamzap/landslide">landslide</a></p>
<p><a href="http://www.printfriendly.com/print/v2?url=http%3A%2F%2Fanr-proteus.github.com%2Fslides%2Fdemo.plain.html"><img alt="printfriendly" src="http://cdn.printfriendly.com/pf-button-both.gif" title="pdf" /></a></p></section>
            
          </div>
          <div class="presenter_notes">
            <header><h1>Presenter Notes</h1></header>
            <section>
            
            </section>
          </div>
          <footer>
            
            <aside class="source">
              Source: <a href="demo.md">demo.md</a>
            </aside>
            
            <aside class="page_number">
              28/28
            </aside>
          </footer>
        </div>
      </div>
      
    </div>
  </div>
  
  <div id="toc" class="sidebar hidden">
    <h2>Table of Contents</h2>
    <table>
      <caption>Table of Contents</caption>
      
      <tr id="toc-row-1">
        <th><a href="#slide1">Demonstration: MORSE &amp; ROS</a></th>
        <td><a href="#slide1">1</a></td>
      </tr>
      
      
      <tr id="toc-row-2">
        <th><a href="#slide2">ROS</a></th>
        <td><a href="#slide2">2</a></td>
      </tr>
      
      
      <tr id="toc-row-3">
        <th><a href="#slide3">rostopic</a></th>
        <td><a href="#slide3">3</a></td>
      </tr>
      
      
      <tr id="toc-row-4">
        <th><a href="#slide4">rostopic: exemple</a></th>
        <td><a href="#slide4">4</a></td>
      </tr>
      
      
      <tr id="toc-row-5">
        <th><a href="#slide5">MORSE</a></th>
        <td><a href="#slide5">5</a></td>
      </tr>
      
      
      <tr id="toc-row-6">
        <th><a href="#slide6">MORSE</a></th>
        <td><a href="#slide6">6</a></td>
      </tr>
      
      
      <tr id="toc-row-7">
        <th><a href="#slide7">MORSE GLSL</a></th>
        <td><a href="#slide7">7</a></td>
      </tr>
      
      
      <tr id="toc-row-8">
        <th><a href="#slide8">MORSE config</a></th>
        <td><a href="#slide8">8</a></td>
      </tr>
      
      
      <tr id="toc-row-9">
        <th><a href="#slide9">MORSE &amp; ROS</a></th>
        <td><a href="#slide9">9</a></td>
      </tr>
      
      
      <tr id="toc-row-10">
        <th><a href="#slide10">MORSE CLI</a></th>
        <td><a href="#slide10">10</a></td>
      </tr>
      
      
      <tr id="toc-row-11">
        <th><a href="#slide11">MORSE: simulation loop</a></th>
        <td><a href="#slide11">11</a></td>
      </tr>
      
      
      <tr id="toc-row-12">
        <th><a href="#slide12">MORSE: scene builder API</a></th>
        <td><a href="#slide12">12</a></td>
      </tr>
      
      
      <tr id="toc-row-13">
        <th><a href="#slide13">Demo: intro</a></th>
        <td><a href="#slide13">13</a></td>
      </tr>
      
      
      <tr id="toc-row-14">
        <th><a href="#slide14">Demo: intro (2)</a></th>
        <td><a href="#slide14">14</a></td>
      </tr>
      
      
      <tr id="toc-row-15">
        <th><a href="#slide15">Demo: intro (video)</a></th>
        <td><a href="#slide15">15</a></td>
      </tr>
      
      
      <tr id="toc-row-16">
        <th><a href="#slide16">ROS Python3 support</a></th>
        <td><a href="#slide16">16</a></td>
      </tr>
      
      
      <tr id="toc-row-17">
        <th><a href="#slide17">Demo: advanced</a></th>
        <td><a href="#slide17">17</a></td>
      </tr>
      
      
      <tr id="toc-row-18">
        <th><a href="#slide18">Demo: advanced (video)</a></th>
        <td><a href="#slide18">18</a></td>
      </tr>
      
      
      <tr id="toc-row-19">
        <th><a href="#slide19">Demo: advanced (code)</a></th>
        <td><a href="#slide19">19</a></td>
      </tr>
      
      
      <tr id="toc-row-20">
        <th><a href="#slide20">Demo: Orocos</a></th>
        <td><a href="#slide20">20</a></td>
      </tr>
      
      
      <tr id="toc-row-21">
        <th><a href="#slide21">RViz (video)</a></th>
        <td><a href="#slide21">21</a></td>
      </tr>
      
      
      <tr id="toc-row-22">
        <th><a href="#slide22">Outdoor (video)</a></th>
        <td><a href="#slide22">22</a></td>
      </tr>
      
      
      <tr id="toc-row-23">
        <th><a href="#slide23">Exploration (Bosch demo w/ Stage)</a></th>
        <td><a href="#slide23">23</a></td>
      </tr>
      
      
      <tr id="toc-row-24">
        <th><a href="#slide24">Exploration (Bosch demo w/ MORSE)</a></th>
        <td><a href="#slide24">24</a></td>
      </tr>
      
      
      <tr id="toc-row-25">
        <th><a href="#slide25">RTMaps</a></th>
        <td><a href="#slide25">25</a></td>
      </tr>
      
      
      <tr id="toc-row-26">
        <th><a href="#slide26">TIPS</a></th>
        <td><a href="#slide26">26</a></td>
      </tr>
      
      
      <tr id="toc-row-27">
        <th><a href="#slide27">Build a robot</a></th>
        <td><a href="#slide27">27</a></td>
      </tr>
      
      
      <tr id="toc-row-28">
        <th><a href="#slide28">That's all Folks!</a></th>
        <td><a href="#slide28">28</a></td>
      </tr>
      
      
    </table>
  </div>
  
  <div id="help" class="sidebar hidden">
    <h2>Help</h2>
    <table>
      <caption>Help</caption>
      <tr>
        <th>Table of Contents</th>
        <td>t</td>
      </tr>
      <tr>
        <th>Exposé</th>
        <td>ESC</td>
      </tr>
      <tr>
        <th>Full screen slides</th>
        <td>e</td>
      </tr>
      <tr>
        <th>Presenter View</th>
        <td>p</td>
      </tr>
      <tr>
        <th>Source Files</th>
        <td>s</td>
      </tr>
      <tr>
        <th>Slide Numbers</th>
        <td>n</td>
      </tr>
      <tr>
        <th>Toggle screen blanking</th>
        <td>b</td>
      </tr>
      <tr>
        <th>Show/hide slide context</th>
        <td>c</td>
      </tr>
      <tr>
        <th>Notes</th>
        <td>2</td>
      </tr>
      <tr>
        <th>Help</th>
        <td>h</td>
      </tr>
    </table>
  </div>
  <script>main()</script>
</body>
</html>